# 财务数据盈利能力图表年份排序修复

## 问题描述
在股票详情页面的财务数据标签页中，"盈利能力"柱状图的年份显示顺序有问题。图表中年份从左到右显示为从高到低（如2024-2021-2018...），而用户期望的是从左到右按时间顺序从低到高排列（如2019-2024）。

## 问题分析
通过代码分析发现，问题出现在后端API `get_financial_indicator_list` 函数中：

**文件位置**: `backend_api/stock/stock_manage.py` 第752行

**问题代码**:
```python
# 按报告期降序排列
df = df.sort_values("报告期", ascending=False)
```

这导致数据按报告期降序排列（从新到旧），前端直接使用这个顺序来渲染图表，所以年份显示是从高到低的。

## 修复方案
将后端的排序从降序改为升序，使年份从左到右按时间顺序从低到高排列。

**修复后的代码**:
```python
# 按报告期升序排列（从旧到新，便于图表从左到右显示）
df = df.sort_values("报告期", ascending=True)
```

## 修复效果
- **修复前**: 年份从左到右是 2024 -> 2023 -> 2022 -> 2021 -> 2020 (高到低)
- **修复后**: 年份从左到右是 2020 -> 2021 -> 2022 -> 2023 -> 2024 (低到高)

## 测试验证
创建了测试脚本验证修复效果：
- `test/test_sorting_logic.py`: 验证排序逻辑的正确性
- `test/test_financial_chart_year_order.py`: 测试API返回数据的排序
- `test/test_financial_chart_simple.py`: 简化版API测试

## 影响范围
- 仅影响财务数据标签页中的"盈利能力"图表
- 不影响其他功能模块
- 向后兼容，不会破坏现有功能

## 修复时间
2024年12月19日

## 修复人员
AI Assistant

## 相关文件
- `backend_api/stock/stock_manage.py`: 主要修复文件
- `test/test_sorting_logic.py`: 排序逻辑测试
- `test/test_financial_chart_year_order.py`: API测试脚本
- `test/test_financial_chart_simple.py`: 简化API测试脚本
