# 数据采集页面更新说明

## 问题解决

用户之前看到的是"功能正在开发中"的占位符页面，这是因为：

1. **端口不匹配**：用户访问的是8001端口的Vite开发服务器，但API服务在5000端口
2. **页面内容过时**：Vue组件版本还是占位符内容
3. **代理配置错误**：Vite代理配置没有正确指向API服务

## 已完成的修复

### 1. 更新Vue组件
- ✅ 将`admin/src/views/DataCollectView.vue`从占位符更新为完整的数据采集功能
- ✅ 包含日期选择、股票代码输入、任务列表和进度显示
- ✅ 支持单个、多个和全量股票采集

### 2. 修复代理配置
- ✅ 更新`admin/vite.config.ts`中的代理配置
- ✅ 将API请求代理到`http://localhost:5000`
- ✅ 更新Vue组件中的API基础URL为`/api`

### 3. 启动服务
- ✅ 启动Vite开发服务器（8001端口）
- ✅ API服务已在5000端口运行

## 访问方式

### 方法1：通过Vite开发服务器（推荐）
```
http://localhost:8001/datacollect
```
- 这是Vue组件版本，功能完整
- 自动代理API请求到5000端口
- 支持热重载

### 方法2：直接访问HTML文件
```
http://localhost:5000/admin/datacollect.html
```
- 这是静态HTML版本
- 需要确保API服务在5000端口运行

## 功能特性

### 数据采集功能
- ✅ 支持单个股票采集
- ✅ 支持多个股票采集（每行一个代码）
- ✅ 支持全量股票采集
- ✅ 测试模式（只采集前5只股票）

### 任务管理
- ✅ 单任务执行（防止并发采集）
- ✅ 实时任务状态更新
- ✅ 任务进度显示
- ✅ 任务取消功能

### 防重复采集
- ✅ 自动检查已存在的数据
- ✅ 跳过重复数据，提高效率

## 使用步骤

1. **确保服务运行**
   - API服务：`python backend_api/main.py`（5000端口）
   - Vite服务：`cd admin && npm run dev`（8001端口）

2. **访问页面**
   - 打开浏览器访问：`http://localhost:8001/datacollect`

3. **配置采集参数**
   - 选择日期范围
   - 选择采集类型（单个/多个/全量）
   - 输入股票代码（如需要）
   - 选择是否测试模式

4. **启动采集**
   - 点击"开始采集"按钮
   - 观察任务进度和状态

## 注意事项

1. **单任务执行**：同时只能有一个采集任务运行
2. **API服务依赖**：确保5000端口的API服务正常运行
3. **数据库连接**：确保数据库连接正常
4. **akshare限流**：系统已考虑akshare的限流要求

## 故障排除

### 如果页面显示"功能正在开发中"
- 检查是否访问了正确的URL：`http://localhost:8001/datacollect`
- 确保Vite开发服务器正在运行
- 检查浏览器控制台是否有错误

### 如果API请求失败
- 确保API服务在5000端口运行
- 检查Vite代理配置是否正确
- 查看浏览器网络面板的请求状态

### 如果采集任务失败
- 检查数据库连接
- 查看API服务日志
- 确认akshare库已安装：`pip install akshare`
